---
lookups:
  randomword:
    module: wishbone.lookup.randomword
  randombool:
    module: wishbone.lookup.randombool
  event:
    module: wishbone.lookup.event

modules:

  input:
    module: wishbone.input.testevent
    arguments:
      message : ~~randomword()
      interval: 1

  modify:
    module: wishbone.function.modify
    arguments:
      expressions:
        - set: [ "Hi", "@tmp.modify.greeting" ]
        - set: [ "one", "base.one" ]
        - copy: [ "base.one", "copy_of_base" ]
        - set: [ "John", "@data.name" ]
        - template: [ "template_result", "{name} is a friendly guy.", "@data" ]
        - set: [ ["ola"], "some_list" ]
        - add_item: [ "new_item", "some_list" ]
        - add_item: [ "hello", "some_list" ]
        - del_item: [ "hello", "some_list" ]
        - uppercase: [ "base.one" ]
        - lowercase: [ "@data.name" ]
        - set: ["one;two", "regextest"]
        - extract: ["extract", '(?P<first>.*?);(?P<second>.*)', "regextest"]
        - time: ["epoch", "X.SSSS"]
        - delete: ["extract.second"]

  output:
    module: wishbone.output.stdout
    arguments:
      prefix: ~~event("@tmp.modify.greeting")
      selection: ""

  error:
    module: wishbone.output.stdout
    arguments:
      selection: ""


routingtable:
  - input.outbox            -> modify.inbox
  - modify.outbox           -> output.inbox
  - modify.failed           -> error.inbox
...
